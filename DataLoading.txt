
from tensorflow.keras.layers import AveragePooling2D
from tensorflow.keras.layers import Dropout
from tensorflow.compat.v1 import InteractiveSession
from tensorflow.keras.layers import Input
from tensorflow.keras.models import Model
import tensorflow as tf
#from keras.utils import np_utils
from keras.utils import to_categorical
from tensorflow.keras.applications import DenseNet121, DenseNet201
import cv2,os
import numpy as np
from sklearn.model_selection import train_test_split
import random
from tensorflow import keras
from tensorflow.keras.preprocessing import image
from tensorflow.keras.models import Model
from tensorflow.keras.layers import Dense, GlobalAveragePooling2D
from keras import callbacks
from keras.preprocessing.image import ImageDataGenerator
from keras.layers import Conv2D, MaxPooling2D, Flatten, BatchNormalization
from tensorflow.keras.models import Sequential
from tensorflow.keras import layers
from tensorflow.keras.applications.inception_v3 import InceptionV3
from keras.applications.inception_resnet_v2 import InceptionResNetV2, preprocess_input
from keras.applications.resnet_v2 import ResNet50V2
from tensorflow.keras.applications.resnet50 import preprocess_input
from tensorflow.keras.preprocessing.image import ImageDataGenerator,load_img
from tensorflow.keras.callbacks import EarlyStopping
from keras import callbacks
from glob import glob
import matplotlib.pyplot as plt
from matplotlib import pyplot as plt
from sklearn.metrics import confusion_matrix
from sklearn.metrics import accuracy_score
from sklearn.metrics import classification_report
import vit_keras
import tensorflow_hub as hub
from sklearn.metrics import plot_confusion_matrix
import seaborn as sns

# load data
data_path=r'Hotmirror'
categories=os.listdir(data_path)
labels=np.arange(len(categories))

label_dict=dict(zip(categories,labels))

img_size=224

data=[]
target=[]

for category in categories:
    folder_path=os.path.join(data_path,category)
    print(folder_path)
    img_names=os.listdir(folder_path)
   # print(img_names)  
    for img_name in img_names:
        img_path=os.path.join(folder_path,img_name)
        img=cv2.imread(img_path)
        #cv2.imshow('LIVE',img)
        #cv2.waitKey(100)
        try:
            #split the dataset into data(images) and target(categorical labels)
            resized=cv2.resize(img,(img_size,img_size))
            data.append(resized)
            target.append(label_dict[category])
            
        except Exception as e:
            print(e)
            
label_dict

#get the data and categorical labels to numpy arrays
data=np.array(data)
target=np.array(target)

#Dividing all the pixels in all the images by 255 in order to convert them to the range 0-1.(Scale the data) 
#This is done to reduce the complexity in training the Neural Network.
data_new=data/255.0

#Converting the labels into categorical representation
#target_new=np_utils.to_categorical(target)
target_new=to_categorical(target, 6)

#saving data and target as numpy array files
np.save('data-transfer-learning1',data_new)
np.save('target-transfer-learning1',target_new)

data=np.load('data-transfer-learning1.npy')
target=np.load('target-transfer-learning1.npy')

#Split the dataset, training and testing
train_data,test_data,train_target,test_target=train_test_split(data,target,test_size=0.2,shuffle=True)